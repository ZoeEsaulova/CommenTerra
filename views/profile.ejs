<!doctype html>
<html class="no-js" lang="en">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CommenTerra | Profile</title>
    <link rel="stylesheet" href="css/commenterra.css" />
    <link rel="stylesheet" href="css/commenterra-icons.css" />
    <link rel="stylesheet" href="css/leaflet.css" />
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/vendor/leaflet.js"></script>
  </head>

  <body>
  	
    <div class="fixed">
    <nav class="top-bar" data-topbar role="navigation">
  		<ul class="title-area"> 
        <li class="name"> 
          <h1><a href="/"> <font face="Helvetica" color="#424242" >&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspCommenTerra</font> </a></h1> 
        </li> 
  			<!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> 
  			<li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li> 
  		</ul>
      <section class="top-bar-section"> 
  			<!-- Right Nav Section --> 
        <ul class="right">
          <li class="has-form">
            <form action="/api/v1" method="post" data-abide>
                <div class="row collapse">
                  <div class="small-9 columns ">
                      <div class "search-field">
                        <label> <input type="text" name="q" id="keyword" placeholder="search for keyword"> </label>
                        <!--small class="error">The Keyword must be alpha-numeric with at least 3 characters!</small -->
                      </div>
                  </div>
                  <div class="small-3 columns end">
                    <button class="success radius expand" type="submit">Search</button>
                  </div>
                </div>
            </form>
          </li>


          <!-- Login -->
  		<li><a href=<%= action %> data-reveal-id="LogInModal"><%= actionName %></a></li>

          <% if (!boolean1) { %>
          <div id="LogInModal" class="reveal-modal" data-reveal>
            <h2>Log In</h2>
            <p class="lead">Please log in with your e-mail and your password</p>
            <p><form data-abide action="/login" method="post">
              <div class="email-field">
                <label>e-Mail 
                  <small>required</small>
                  <input type="email" id="email" placeholder="info@commenterra.com" name="email" required pattern="email">  
                </label>
                <small class="error">Please type in a valid e-mail-adress!</small>
              </div>
              <div class="password-field">
                <label>Password 
                  <small>required</small>
                  <input type="password" id="password" placeholder="P4s$w0rd!" name="password" required> 
                </label>
                <small class="error">Please type in your password!</small>
              </div>
              <button id="LogInModal2" class="radius" type="submit">Log In</button>
            </form></p>
            <a class="close-reveal-modal">&#215;</a>
          </div>
          <% } %>



  				<li class="has-dropdown"> 
  					<a href="#">Site Navigation</a> 
  					<ul class="dropdown"> 
  						<li><a href="/comments/add">New Comment</a></li> 
  						<li><a href="/api/v1/search">Advanced Search</a></li>
              			<li><a href="/faq">Help / FAQ</a></li> 

<!-- TO DO: Funktionalität - edit Profile, Rollenzugriff auf Profilseite -->
			<% if ((boolean1) && (boolean3)) {%> 
			<li><a data-reveal-id="SettingsModal">Profile Settings</a></li>
                <div id="SettingsModal" class="reveal-modal" data-reveal>
                  <h2>Profile Settings</h2>
                  <p class="lead">Here you can change your profile and the information you want to share with other users.</p>
                  <ul class="small-block-grid-3">
                    <li>
                      <form action="/profile/<%= user._id %>" method="post" data-abide>
                        <!--div class="name-field">
                          <label>Username
                            <input type="text" id="username" placeholder="<%= user.local.username %>" name="username">
                          </label>
                        </div-->
                        <div class="email-field">
                          <label>E-Mail
                            <input type="email" id="email" placeholder="<%= user.local.email %>" name="email" pattern="email">
                          </label>
                          <small class="error">Please type in a valid e-mail-adress!</small>
                        </div>
                        <!--div class="password-field">
                          <label>Password
                            <input type="password" id="password" placeholder="Create a new password" name="password">
                          </label>
                        </div-->
                        <div class="small-12 columns">
                          <label>Country
                            <input type="text" id="firstname" placeholder="<%= user.country %>" name="country">
                          </label>
                        </div>                        
                      
                    </li>
                    <li>
                      
                        <div class="small-12 columns">
                          <label>First Name
                            <input type="text" id="firstname" placeholder="<%= user.firstname %>" name="firstname">
                          </label>
                        </div>
                        <div class="small-12 columns">
                          <label>Last Name
                            <input type="text" id="lastname" placeholder="<%= user.lastname %>" name="lastname">
                          </label>
                        </div>
                        <div class="small-12 columns">
                          <label>Profession
                            <input type="text" id="profession" placeholder="<%= user.profession %>" name="profession">
                          </label>
                        </div>
                      
                    </li>
                    <li>
                      
                        <div class="row">
                          <div class="large-12 columns">
                            <label>About Me
                              <textarea id="about" placeholder="Write something about yourself" name="about"></textarea>
                            </label>
                          </div>
                        </div>
                      
                    </li>
                  </ul>
                  <button id="numero2" class="tiny radius expand" type="submit"><font color="#424242">Save Changes</font></button>
                  <a class="close-reveal-modal">&#215;</a>
                  </form>
                </div>      
			 <%} %>
              


 
  					</ul> 
  				</li> 
  			</ul> 
  		</section>
  	</nav>
    </div>

    <div class="fixed-under">
      <nav class="top-bar-border"></nav>
    </div>

    <strong class="show-for-large-up">
      <div class="panel custom">
        <!--oberer grauer Balken-->
        <ul class="large-block-grid-3">
          <li>
            <img src="img/empty_avatar.svg" width="205" height="205">
          </li>
          <li>
            <div><p><font color="white">Username: </font><font color="white" size="5"><%= pageowner.local.username %></font></p></div>
            <div><p><font color="white">Email: </font><font color="white" size="5"><%= pageowner.local.email %></font></p></div>            
          	<% if (pageowner.firstname) {%>
          		<div><p><font color="white">First Name: </font><font color="white" size="5"><%= pageowner.firstname%></font></p></div>
          	<%} %>        
          	<% if (pageowner.lastname) {%>
          		<div><p><font color="white">Last Name: </font><font color="white" size="5"><%= pageowner.lastname %></font></p></div>
          	<%} %> 
          	<% if (pageowner.profession) {%>
          		<div><p><font color="white">Profession: </font><font color="white" size="5"><%= pageowner.profession %></font></p></div>
          	<%} %> 
          	<% if (pageowner.country) {%>
          		<div><p><font color="white">Country: </font><font color="white" size="5"><%= pageowner.country %></font></p></div>
          	<%} %>            	          	          	          	    
              <br><br><font color="white">User Rating: </font>
              <font color="#80FF00" size="5">&nbsp&nbsp36&nbsp&nbsp</font><i class="fi-like size-28 font-green"></i>
              <font color="#c60f13" size="5">&nbsp&nbsp12&nbsp&nbsp</font><i class="fi-dislike size-28 font-alert"></i></p>
            </div>
          </li>
          <li>
            <% if (pageowner.about) {%>
            <div><p class="text-justify"><font color="red">About Me:</font><br><br><font color="red" size ="5"><%= pageowner.about %></font></p></div>
          	<%} %>          	

          </li>
        </ul>
      </div>
    </strong>

    <strong class="show-for-medium-only">
      <div class="panel custom">
        <!--oberer grauer Balken-->
        <ul class="small-block-grid-2">
          <li>
            <div><p><font color="white">Username: </font><font color="white" size="5">J4NU5!</font></p></div>
            <div><p><font color="white">First Name: </font><font color="white" size="5">Jan</font></p></div>
            <div><p><font color="white">Last Name: </font><font color="white" size="5">Ehrecke</font></p></div>
            <div><p><font color="white">Profession: </font><font color="white" size="5">Student</font>
              <br><br><font color="white">User Rating: </font>
              <font color="#80FF00" size="5">&nbsp&nbsp36&nbsp&nbsp</font><i class="fi-like size-28 font-green"></i>
              <font color="#c60f13" size="5">&nbsp&nbsp12&nbsp&nbsp</font><i class="fi-dislike size-28 font-alert"></i></p>
            </div>
          </li>
          <li>
            <div><p class="text-justify"><font color="white">About Me:</font><br><br><font color="white" size ="5">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</font></p></div>
          </li>
        </ul>
      </div>
    </strong>

    <strong class="show-for-small-only">
      <div class="panel custom">
        <!--oberer grauer Balken-->
        <div><p><font color="white">Username: </font><font color="white" size="5">J4NU5!</font></p></div>
        <div><p><font color="white">First Name: </font><font color="white" size="5">Jan</font></p></div>
        <div><p><font color="white">Last Name: </font><font color="white" size="5">Ehrecke</font></p></div>
        <div><p><font color="white">Profession: </font><font color="white" size="5">Student</font>
          <br><br><font color="white">User Rating: </font>
          <font color="#80FF00" size="5">&nbsp&nbsp36&nbsp&nbsp</font><i class="fi-like size-28 font-green"></i>
          <font color="#c60f13" size="5">&nbsp&nbsp12&nbsp&nbsp</font><i class="fi-dislike size-28 font-alert"></i></p>
        </div>
        <div><p class="text-justify"><font color="white">About Me:</font><br><br><font color="white" size ="5">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</font></p></div>
      </div>
    </strong>

    <div class="panel custom2">
      <!--unterer grauer Bereich-->
			<% if ((boolean1) && (boolean3)) {%> 
      <ul class="small-block-grid-2">
        <li>
          <a href="/comments/add" class="success button radius expand">New Comment</a>
        </li>
        <li>
          <a href="/api/v1/search" class="success button radius expand">Advanced Search</a>
        </li>
      </ul> 
			 <%} %>      


      <strong class="hide-for-large-up">
        <div class="panel custom">

          <dl class="tabs" data-tab>
            <dd><a href="#panel1">View Comments</a></dd>
            <dd class="content active"><a href="#panel2">View Map</a></dd>
          </dl>

          <div class="tabs-content">

            <div class="content" id="panel1">
              <!-- Kommentare -->
              <dl class="accordion" data-accordion>

                <% for(var i=0; i<comments.length; i++) {%>

                <dd data-ng-repeat="comment in comments" class="accordion-navigation">
                  <a href="#panel<%= i %>b"><%= comments[i].title %></a>
                  <div id="#panel<%= i %>b" class="content">
                    <ul class="no-bullet">
                    <li>
                      <a href="/api/v1/search?url=<%= comments[i].dataset.url %>"><font color="#2ba6cb"><%= comments[i].dataset.url %></font></a>
                      <p>
                      <a href="#"><i class="fi-star size-28 font-green"></i></a>
                      <a href="#"><i class="fi-star size-28 font-green"></i></a>
                      <a href="#"><i class="fi-star size-28 font-green"></i></a>
                      <a href="#"><i class="fi-star size-28 font-green"></i></a>
                      <a href="#"><i class="fi-star size-28 font-grey"></i></a>
                      &nbsp&nbsp&nbsp&nbsp<%= comments[i].dateString %>
                    </li>
                    </ul>
                      <%= comments[i].text %>
                      <p>
                    <ul class="no-bullet">
                    <li>
                    
                      <% if (comments[i].user) {%>
                      <a href="/profile/<%= comments[i].user._id %>"><font color="#2ba6cb"><%= comments[i].user.local.username %></font></a>
                  <%} else {%> 
                    <font color="#2ba6cb">Anonymous</font>
                  <%} %>                      
                      <font color="#80FF00">&nbsp&nbsp&nbsp&nbsp12&nbsp&nbsp</font><a href="#"><i class="fi-like size-28 font-green"></i></a>
                      <font color="#c60f13">&nbsp&nbsp&nbsp&nbsp0&nbsp&nbsp</font><a href="#"><i class="fi-dislike size-24 font-alert"></i></a>
                      &nbsp&nbsp&nbsp&nbsp
                    <a href="/comments/addtothread/<%= comments[i].dataset.url %>/<%= comments[i]._id %>"><i class="fi-comment size-21 font-success"></i></a>                      
                    </li>
                    </ul>
                  <% if (comments[i].comments.length>0) {%>
                  
                      <% for (var j=0; j<comments[i].comments.length; j++) {%>
                          <div class="content">
                            <p id="lastStop"><%= comments[i].comments[j].title %></p>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-grey"></i></a>
                            <p><%= comments[i].comments[j].text %></p>
                            <p><%= comments[i].comments[j].dateString %></p>
                              <% if (comments[i].comments[j].user) {%>
                            <!-- HERE SCRIPT TO POPULATE COMMENTS1 -->
                              <a href="/profile/<%= comments[i].comments[j].authorName %>"><font color="#2ba6cb">
                                <%= comments[i].comments[j].authorName %>
                              </font></a>
                            <%} else {%> 
                              <font color="#2ba6cb">Anonymous</font>
                            <%} %>
                          </div>

                        <%} 
                      %>
                  <%} %>                    
                  </div>
                </dd>
                <% } %>
              </dl>
            </div>

            <div class="content active" id="panel2">
              <!-- Karte -->
              <div class="map" id="map" style="width: 100%; height: 750px"></div>
 
            </div>

          </div>

        </div>
      </strong>     

<strong class="show-for-large-up" >
      <ul class="small-block-grid-2" data-equalizer>
        <li>
          <div class="panel custom" style="overflow: auto" data-equalizer-watch >
            <!-- Kommentare -->
            <dl class="accordion" data-accordion>
              <% for(var i=0; i<comments.length; i++) {%>
              <dd class="accordion-navigation">

                <a id="lastStop" href="#panel<%= i %>c"><%= comments[i].title %></a>

                <div id="panel<%= i %>c" class="content">
                  <ul class="no-bullet">
                  <li>
                    <a href="/api/v1/search?url=<%= comments[i].dataset.url %>"><font color="#2ba6cb"><%= comments[i].dataset.url %></font></a>
                    <p>
                    <a href="#"><i class="fi-star size-28 font-green"></i></a>
                    <a href="#"><i class="fi-star size-28 font-green"></i></a>
                    <a href="#"><i class="fi-star size-28 font-green"></i></a>
                    <a href="#"><i class="fi-star size-28 font-green"></i></a>
                    <a href="#"><i class="fi-star size-28 font-grey"></i></a>
                    &nbsp&nbsp&nbsp&nbsp<%= comments[i].dateString %>
                  </li>
                  </ul>
                  <%= comments[i].text %>
                  <p>
                  <ul class="no-bullet">
                  <li>
                    <% if (comments[i].user) {%>
                  
                    <a href="/profile/<%= comments[i].user._id %>"><font color="#2ba6cb"><%= comments[i].user.local.username %>
                    </font></a>
                  <%} else {%> 
                    <font color="#2ba6cb">Anonymous</font>
                  <%} %>

                    <font color="#80FF00">&nbsp&nbsp&nbsp&nbsp12&nbsp&nbsp</font><a href="#"><i class="fi-like size-28 font-green"></i></a>
                    <font color="#c60f13">&nbsp&nbsp&nbsp&nbsp0&nbsp&nbsp</font><a href="#"><i class="fi-dislike size-24 font-alert"></i></a>
                    &nbsp&nbsp&nbsp&nbsp
                    <a href="/comments/addtothread/<%= comments[i].dataset.url %>/<%= comments[i]._id %>"><i class="fi-comment size-21 font-success"></i></a>
                  
                  </li>
                  </ul> 
                  <% if (comments[i].comments.length>0) {%>
                  
                      <% for (var j=0; j<comments[i].comments.length; j++) {%>
                          <div class="content">
                            <p id="lastStop"><%= comments[i].comments[j].title %></p>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-green"></i></a>
                            <a href="#"><i class="fi-star size-28 font-grey"></i></a>
                            <p><%= comments[i].comments[j].text %></p>
                            <p><%= comments[i].comments[j].dateString %></p>
                              <% if (comments[i].comments[j].user) {%>
                            <!-- HERE SCRIPT TO POPULATE COMMENTS1 -->
                              <a href="/profile/<%= comments[i].comments[j].authorName %>"><font color="#2ba6cb">
                                <%= comments[i].comments[j].authorName %>
                              </font></a>
                            <%} else {%> 
                              <font color="#2ba6cb">Anonymous</font>
                            <%} %>
                          </div>

                        <%} 
                      %>
                  <%} %>

                </div>


              </dd>
              <% } %>

            </dl>
          </div>
        </li>
        <li>
          <div class="panel custom" data-equalizer-watch>
            <!-- Karte -->
            <div id="numero5">
            <div class="map" id="map1" style="width: 100%; height: 1000px; border-radius: 3px"></div>
            </div>

          </div>
        </li>
      </ul>
</strong>

    </div>

              <script>
              
              if (matchMedia('only screen and (max-width: 64em)').matches) {
                //Karte für kleine Bildschirme
                var map = L.map('map');

                L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                  maxZoom: 20,
                  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery © <a href="http://mapbox.com">Mapbox</a>',
                  id: 'examples.map-i875mjb7'
                }).addTo(map);

                function onLocationFound(e) {
                  var radius = e.accuracy / 2;

                  L.marker(e.latlng).addTo(map)
                  .bindPopup("You are within " + radius + " meters from this point").openPopup();

                  L.circle(e.latlng, radius, {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map);
                }

                function onLocationError(e) {
                  map.setView([51.96935, 7.59588], 13);
                  alert(e.message);
                }

                map.on('locationfound', onLocationFound);
                map.on('locationerror', map.setView([51.96935, 7.59588], 13), onLocationError);

                map.locate({setView: true, maxZoom: 13});
                
                L.marker([51.96935, 7.59588]).addTo(map)
                  .bindPopup("<b>Hello everyone!</b><br />This is the GEO1 in Münster.").openPopup();

                L.polygon([
                  [51.97424, 7.59757],
                  [51.97415, 7.59839],
                  [51.97321, 7.59819],
                  [51.97326, 7.59736]], {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map).bindPopup("This is an ordinary football-field at the WWU's sports ground.");

                var popup = L.popup();

                function onMapClick(e) {
                  popup
                  .setLatLng(e.latlng)
                  .setContent("You clicked the map at " + e.latlng.toString())
                  .openOn(map);
                }

                map.on('click', onMapClick);
              }

              if (matchMedia('only screen and (min-width: 64.063em)').matches) {
                //Karte für mittlere Bildschirme
                var map1 = L.map('map1');
                //var map1 = L.map('map1').setView([51.96935, 7.59588], 13);

                L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                  maxZoom: 20,
                  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery © <a href="http://mapbox.com">Mapbox</a>',
                  id: 'examples.map-i875mjb7'
                }).addTo(map1);

                function onLocationFound1(e) {
                  var radius1 = e.accuracy / 2;

                  L.marker(e.latlng).addTo(map1)
                  .bindPopup("You are within " + radius1 + " meters from this point").openPopup();

                  L.circle(e.latlng, radius1, {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map1);
                }

                function onLocationError1(e) {
                  alert(e.message);
                }

                map1.on('locationfound', onLocationFound1);
                map1.on('locationerror', map1.setView([51.96935, 7.59588], 13), onLocationError1);

                map1.locate({setView: true, maxZoom: 16});
                
                L.marker([51.96935, 7.59588]).addTo(map1)
                  .bindPopup("<b>Hello everyone!</b><br />This is the GEO1 in Münster.").openPopup();

                L.polygon([
                  [51.97424, 7.59757],
                  [51.97415, 7.59839],
                  [51.97321, 7.59819],
                  [51.97326, 7.59736]], {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map1).bindPopup("This is an ordinary football-field at the WWU's sports ground.");


                function onMapClick1(e) {
                  popup
                  .setLatLng(e.latlng)
                  .setContent("You clicked the map at " + e.latlng.toString())
                  .openOn(map1);
                }

                map1.on('click', onMapClick1);

              }

              </script>

    <div class="panel custom4" style="width: 100%; height: 2px"></div>

    <!--footer-->
    <div class="panel custom4" style="width: 100%; height: 2px"></div>
    <div id="footer">
    ´ <a href="/about"><font color="#424242">About CommenTerra / Contact</font>nbsp&nbsp&nbsp&nbsp0&nbsp&nbsp</a>
      <a href="/faq"><font color="#424242">FAQ / Help</font></a> 
      <!--div ng-include src="'test.html'"></div-->
    </div>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>

    <script>
      $(document).foundation();
    </script>

  </body>

</html>